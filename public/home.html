<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau de bord - Accueil</title>
    <link rel="stylesheet" href="/public/css/home.css">
    <link rel="stylesheet" href="css/mobiscroll.javascript.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="dashboard">
        <div id="sidebar"></div>
        <main class="main-content">
            <div class="report-header">
                <h2>Suivi des performances</h2>
                <div class="profile-container">
                    <div class="profile-icon">
                        <img src="https://via.placeholder.com/40" alt="Photo de profil">
                    </div>
                    <div class="profile-name">Kylian Mbappé</div>
                </div>
            </div>
            <div class="main-section">
                <div class="left-section">
                    <div class="report-controls">
                        <select name="week" id="week-select">
                            <option value="current">Semaine actuelle</option>
                            <option value="previous">Semaine précédente</option>
                        </select>
                    </div>
                    <div class="report-section">
                        <div class="report-card performance-card">
                            <div class="report-title">Dernières performances</div>
                            <div class="report-percentage">+5%</div>
                            <div class="report-value">Squat : 120kg</div>
                            <div class="report-previous">Semaine dernière : 115kg</div>
                        </div>
                        <div class="report-card game-time-card">
                            <div class="report-title">Temps de jeu</div>
                            <div class="report-percentage">+10%</div>
                            <div class="report-value">15 heures</div>
                            <div class="report-previous">Semaine dernière : 13 heures</div>
                        </div>
                        <div class="report-card calories-card">
                            <div class="report-title">Calories brûlées</div>
                            <div class="report-percentage">+20%</div>
                            <div class="report-value">650 Kcal</div>
                            <div class="report-subtitle">Objectif : 1500 Kcal</div>
                        </div>
                    </div>
                </div>
                <div class="progression-section">
                    <div class="task-completion-card">
                        <div class="progression-title">Progression</div>
                        <div class="circle-container">
                            <canvas id="taskCompletionChart"></canvas>
                            <div id="chart-center-text">71%</div>
                        </div>
                    </div>
                </div>
            </div>
            <div mbsc-page class="demo-mobile-day-view">
                <div style="height:1%">
                    <div id="demo-mobile-day-view"></div>
                </div>
            </div>
        </main>
    </div>
    <div id="event-form">
        <label for="event-title">Nom</label>
        <input type="text" id="event-title" placeholder="">
        <div id="color-options">
            <div class="color-option" data-color="#4981d6" style="background-color: #4981d6;"></div>
            <div class="color-option" data-color="#C1FF72" style="background-color: #C1FF72;"></div>
            <div class="color-option" data-color="#ff5e57" style="background-color: #ff5e57;"></div>
            <div class="color-option" data-color="#ffa726" style="background-color: #ffa726;"></div>
        </div>
    </div>
    <script src="js/mobiscroll.javascript.min.js"></script>
    <script>mobiscroll.setOptions({
        locale: mobiscroll.localeFr,
        theme: 'ios',
        themeVariant: 'dark'
    });
    
    var inst = mobiscroll.eventcalendar('#demo-mobile-day-view', {
        view: {
            schedule: {
                type: 'week',
                startTime: '06:00',
                endTime: '24:00',
                allDay: false
            }
        },
        dragToCreate: true,
        dragToMove: true,
        dragToResize: true,
        onEventClick: function (args) {
            var form = document.getElementById('event-form');
            form.style.display = 'block';
            form.style.left = args.domEvent.clientX + 'px';
            form.style.top = args.domEvent.clientY + 'px';
    
            document.getElementById('event-title').value = args.event.title;
    
            document.querySelectorAll('.color-option').forEach(option => {
                if (option.getAttribute('data-color') === args.event.color) {
                    option.classList.add('selected');
                } else {
                    option.classList.remove('selected');
                }
            });
    
            document.getElementById('event-title').oninput = function () {
                args.event.title = this.value;
                inst.updateEvent(args.event);
            };
    
            document.querySelectorAll('.color-option').forEach(option => {
                option.onclick = function () {
                    document.querySelectorAll('.color-option').forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
    
                    args.event.color = this.getAttribute('data-color');
                    inst.updateEvent(args.event);
                };
            });
        },
        data: [
            { color: '#4981d6', start: '2024-11-16T08:00', end: '2024-11-16T09:00', title: 'Entraînement cardio' },
            { color: '#C1FF72', start: '2024-11-16T12:00', end: '2024-11-16T13:30', title: 'Séance de musculation' },
            { color: '#ff5e57', start: '2024-11-16T15:00', end: '2024-11-16T16:00', title: 'Yoga' },
            { color: '#ffa726', start: '2024-11-16T18:00', end: '2024-11-16T19:00', title: 'Boxe' }
        ]
    });
    
    document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('event-form').style.display = 'none';
    
        var ctx = document.getElementById('taskCompletionChart').getContext('2d');
        new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['Complet', 'Manqué'],
                datasets: [{
                    data: [71, 29],
                    backgroundColor: [
                        'rgba(255, 105, 180, 0.8)',
                        '#333'
                    ],
                    hoverBackgroundColor: [
                        'rgba(255, 105, 180, 1)',
                        '#333' 
                    ],
                    borderWidth: 0 
                }]
            },
            options: {
                responsive: true,
                cutout: '70%',
                plugins: {
                    legend: {
                        display: false 
                    }
                },
                elements: {
                    arc: {
                        borderRadius: 20,
                    }
                },
                animation: {
                    animateRotate: true,
                    animateScale: true
                }
            }
        });
    
        var chartCanvas = document.getElementById('taskCompletionChart');
        chartCanvas.style.filter = 'drop-shadow(0px 0px 15px rgba(255, 105, 180, 0.7))';
    });
    
    document.addEventListener('click', function (e) {
        var form = document.getElementById('event-form');
        if (!form.contains(e.target) && !e.target.closest('.mbsc-schedule-event')) {
            form.style.display = 'none';
        }
    });
    
    fetch('sidebar.html')
        .then(response => response.text())
        .then(data => {
            document.getElementById('sidebar').innerHTML = data;
        })
        .catch(error => console.error('Erreur lors du chargement de la sidebar:', error));
    
    </script>
</body>
</html>
